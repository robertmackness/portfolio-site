var portfolioApp=angular.module("portfolioApp",["ngRoute","ngResource"]);portfolioApp.config(["$routeProvider",function(e){e.when("/",{templateUrl:"assets/templates/template-main.html"}).when("/portfolio",{templateUrl:"assets/templates/template-portfolio.html"}).when("/portfolio/customerserviceportal",{templateUrl:"assets/templates/template-portfolio-customer-service-portal.html"})}]),portfolioApp.factory("CustomersAPI",["$resource",function(e){return e("/customersAPI/:id",{id:"@id"},{edit:{method:"PUT",params:{id:"id"}}})}]),portfolioApp.directive("customerCardBrief",function(){return{templateUrl:"/assets/templates/directives/customerCardBrief.html",scope:{customers:"="}}}),portfolioApp.directive("customerCardFull",function(){return{templateUrl:"/assets/templates/directives/customerCardFull.html",scope:{customer:"=",toggleModalEdit:"&",toggleModalDelete:"&"}}}),portfolioApp.directive("customerModalDialogueEdit",function(){return{templateUrl:"/assets/templates/directives/customerCardModalEdit.html",scope:{showModalEdit:"=",currentCustomer:"=",submitChanges:"&",hideModal:"&"}}}),portfolioApp.directive("customerModalDialogueDelete",function(){return{templateUrl:"/assets/templates/directives/customerCardModalDelete.html",scope:{showModalDlete:"=",currentCustomer:"=",deleteCurrentCustomer:"&",hideModal:"&"}}}),portfolioApp.directive("customerModalDialogueCreate",function(){return{templateUrl:"/assets/templates/directives/customerCardModalCreate.html",scope:{newCustomerObject:"=",showModalCreate:"=",submitNewCustomer:"&",hideModal:"&"}}}),portfolioApp.controller("customerServicePortal",["$scope","$resource","CustomersAPI",function(e,t,o){e.currentCustomer={},e.customers=[],e.searchString="",e.customers=o.query(function(){e.customers[0]&&(e.currentCustomer=e.customers[0])}),e.setCurrentCustomerId=function(t){e.currentCustomer=t};var r;e.$watch("searchString",function(){r&&clearTimeout(r),r=setTimeout(function(){e.customers=o.query({searchString:e.searchString},function(){e.customers[0]&&(e.currentCustomer=e.customers[0])})},500)}),e.showModalEdit=!1,e.toggleModalEdit=function(){e.showModalEdit=!0},e.hideModalEdit=function(){e.showModalEdit=!1,e.currentCustomer=o.get({id:e.currentCustomer._id})},e.submitChanges=function(t){o.edit({customerObject:t},function(){e.customers=o.query({searchString:e.searchString},function(){e.currentCustomer=o.get({id:e.customers[0]._id}),e.showModalEdit=!1})})},e.newCustomer={},e.showModalCreate=!1,e.toggleModalCreate=function(){e.showModalCreate=!0},e.hideModalCreate=function(){e.showModalCreate=!1},e.submitNewCustomer=function(t){o.save({customerObject:t},function(t){e.showModalCreate=!1,e.currentCustomer=o.get({id:t._id}),e.searchString=""})},e.showModalDelete=!1,e.toggleModalDelete=function(){e.showModalDelete=!e.showModalDelete},e.hideModalDelete=function(){e.showModalDelete=!1},e.deleteCurrentCustomer=function(){e.showModalDelete=!1,o["delete"]({id:e.currentCustomer._id},function(){e.customers[0]._id&&(e.currentCustomer=o.get({id:e.customers[0]._id}))})}}]);